(()=>{var a=(Math.random()*1e4).toString().substr(0,4),e,l=!0,d=new Peer(a),t=document.getElementById("localVideo"),n=document.getElementById("remoteVideo"),s=document.getElementById("callButton"),i=document.getElementById("camSwitch"),r=document.getElementById("toggleFullScreen"),m=document.getElementById("input"),u=document.getElementById("number");window.onload=async()=>{e=await navigator.mediaDevices.getUserMedia({video:!0,audio:!0})};var g=document.createTextNode(a);u.appendChild(g);i.addEventListener("click",async()=>{l=!l,t.srcObject.getTracks().forEach(c=>{c.stop()}),e=await navigator.mediaDevices.getUserMedia({audio:!0,video:{facingMode:l?"user":"environment"}}),t.srcObject=e});r.addEventListener("click",()=>v());function v(){document.fullscreenElement?document.exitFullscreen&&document.exitFullscreen():document.documentElement.requestFullscreen()}s.onclick=()=>{t.srcObject=e,d.call(m.value,e).on("stream",o=>{t.classList.add("small"),n.classList.add("active"),n.srcObject=o})};d.on("call",c=>{setTimeout(()=>{c.answer(e),t.srcObject=e,c.on("stream",o=>{t.classList.add("small"),n.classList.add("active"),n.srcObject=o})},2e3)});})();

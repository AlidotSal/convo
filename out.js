(()=>{var o=(Math.random()*1e4).toString().substr(0,4),t,a=new Peer(o);window.onload=async()=>{t=await navigator.mediaDevices.getUserMedia({video:!0,audio:!0})};var c=document.getElementById("localVideo"),d=document.getElementById("remoteVideo"),i=document.getElementById("callButton"),r=document.getElementById("camSwitch"),l=document.getElementById("input"),m=document.getElementById("number"),s=document.createTextNode(o);m.appendChild(s);r.addEventListener("click",async()=>{c.srcObject.getTracks().forEach(e=>e.stop()),t=await navigator.mediaDevices.getUserMedia({audio:!0,video:{facingMode:{exact:"environment"}}})});i.onclick=()=>{c.srcObject=t;let e=a.call(l.value,t);c.onloadedmetadata=function(){c.play()},e.on("stream",n=>{d.srcObject=n})};a.on("call",e=>{e.answer(t),c.srcObject=t,e.on("stream",n=>{d.srcObject=n})});})();

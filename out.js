(()=>{var d=(Math.random()*1e4).toString().substr(0,4),t,o,s=!0,l=new Peer(d),e=document.getElementById("localVideo"),n=document.getElementById("remoteVideo"),i=document.getElementById("callButton"),r=document.getElementById("camSwitch"),u=document.getElementById("hangUp"),m=document.getElementById("toggleFullScreen"),g=document.getElementById("input"),b=document.getElementById("number");window.onload=async()=>{t=await navigator.mediaDevices.getUserMedia({video:!0,audio:!0})};var v=document.createTextNode(d);b.appendChild(v);r.addEventListener("click",async()=>{s=!s,e.srcObject.getTracks().forEach(c=>{c.stop()}),t=await navigator.mediaDevices.getUserMedia({audio:!0,video:{facingMode:s?"user":"environment"}}),e.srcObject=t});m.addEventListener("click",()=>E());function E(){document.fullscreenElement?document.exitFullscreen&&document.exitFullscreen():document.documentElement.requestFullscreen()}i.onclick=()=>{e.srcObject=t,o=l.call(g.value,t),o.on("stream",c=>{e.classList.add("small"),n.classList.add("active"),n.srcObject=c})};l.on("call",c=>{setTimeout(()=>{c.answer(t),e.srcObject=t,c.on("stream",a=>{e.classList.add("small"),n.classList.add("active"),n.srcObject=a})},2e3)});u.addEventListener("click",()=>{o.close(),l.disconnect(),e.srcObject=null,n.srcObject=null});l.on("close",()=>{l.disconnect(),e.srcObject=null,n.srcObject=null});})();

(()=>{var u=(Math.random()*1e4).toString().substr(0,4),d,o,i,m;var n=new Peer(u),s=document.getElementById("localVideo"),a=document.getElementById("remoteVideo"),g=document.getElementById("callButton"),r=document.getElementById("answer"),p=document.getElementById("camera"),v=document.getElementById("mic"),E=document.getElementById("hangUp"),b=document.getElementById("toggleFullScreen"),h=document.getElementById("input"),T=document.getElementById("number"),B=document.getElementById("text"),k=document.getElementById("send"),y=document.getElementById("chat"),f=document.getElementsByClassName("messaging-area")[0];function L(e){s.classList.add("small"),a.classList.add("active"),a.srcObject=e,g.classList.remove("visiable"),r.classList.remove("visiable"),f.classList.add("visiable"),E.classList.add("visiable"),b.classList.add("visiable"),p.classList.add("visiable"),v.classList.add("visiable"),s.srcObject=d,console.log(e.getVideoTracks()[0].getSettings().height,e.getVideoTracks()[0].getSettings().width)}window.onload=async()=>{d=await navigator.mediaDevices.getUserMedia({audio:!0,video:{width:{min:576,ideal:720,max:1080},height:{min:1024,ideal:1280,max:1920}}})};var w=document.createTextNode(u);T.appendChild(w);p.addEventListener("click",()=>{o.getVideoTracks()[0].enabled=!o.getVideoTracks()[0].enabled});v.addEventListener("click",async()=>{o.getAuduiTracks()[0].enabled=!o.getAudioTracks()[0].enabled});b.addEventListener("click",()=>x());function x(){document.fullscreenElement?document.exitFullscreen&&document.exitFullscreen():document.documentElement.requestFullscreen()}k.addEventListener("click",()=>{let e=document.createElement("P"),t=document.createElement("SPAN"),c=document.createTextNode(B.value);t.appendChild(c),e.appendChild(t),y.appendChild(e),e.classList.add("sent"),m.send(B.value)});E.addEventListener("click",()=>{i.close(),n.disconnect(),n.destroy(),s.srcObject=null,a.srcObject=null});g.onclick=()=>{s.srcObject=d,i=n.call(h.value,d,{sdpTransform:e=>{}}),i.on("stream",L),m=n.connect(h.value)};n.on("call",e=>{let t=document.createElement("H2"),c=document.createTextNode(`The ID ${e.peer} is calling...`);t.appendChild(c),document.body.appendChild(t),r.classList.add("visiable"),r.addEventListener("click",()=>{e.answer(d,{sdpTransform:l=>{}}),t.remove(),e.on("stream",L),m=n.connect(e.peer)})});n.on("connection",function(e){e.on("open",function(){e.on("data",function(t){console.log(t);let c=document.createElement("P"),l=document.createElement("SPAN"),I=document.createTextNode(t);l.appendChild(I),c.appendChild(l),y.appendChild(c),c.classList.add("received")})})});n.on("disconnected",()=>{n.destroy(),s.srcObject=null,a.srcObject=null});})();
